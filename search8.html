
<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Search | Chinese Association of Mississauga</title>

  <!-- 统一：公共导航/页脚样式 -->
  <link rel="stylesheet" href="cam-layout.css" />

  <!-- 本页 Search 专属样式（不覆盖公共导航/页脚） -->
  <style>
    :root{
      --text:#1e293b; --bg:#f8fafc; --card:#fff; --shadow:0 8px 24px rgba(2,6,23,.08);
      --radius:14px; --teal:#1f9a8a; --line:#d4e9e3;
    }
    *{box-sizing:border-box}
    body{margin:0;font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);background:var(--bg)}
    img{max-width:100%;height:auto;display:block}
    .container{max-width:1200px;margin-inline:auto;padding:0 20px}
/* 顶部主导航 & 下拉触发 */
.main-nav a,
.main-nav .drop-toggle {
  text-decoration: none;
}

/* 悬停/聚焦时也不出现下划线，只用背景高亮表现 */
.main-nav a:hover,
.main-nav a:focus-visible,
.main-nav .drop-toggle:hover,
.main-nav .drop-toggle:focus-visible {
  text-decoration: none;
}
.drawer nav a,
.drawer nav .drawer-toggle {
  text-decoration: none;
}

    /* Hero */
    .page-hero{background:#cfeee3;padding:28px 0;border-bottom:1px solid #e5f3ef;margin-bottom:16px}
    .page-hero h1{margin:0;text-align:center;color:var(--teal);font-size:clamp(26px,4vw,38px);font-weight:800}

    /* 结果列表 */
    .results{display:grid;grid-template-columns:1fr;gap:14px;margin:18px 0 32px}
    .card{background:var(--card);border:1px solid #e5e7eb;border-radius:12px;padding:16px;box-shadow:var(--shadow)}
    .card h3{margin:0 0 6px}
    .card p{margin:6px 0 0;color:#475569}
    mark{background:#fff3a3;padding:0 2px;border-radius:3px}
  </style>
</head>
<body>
  <!-- Header（来自 cam-layout.css 的统一导航） -->
  <header>
    <div class="topbar container">
      <a class="logo" href="home.html" aria-label="Home"><img src="1.jpeg" alt="Chinese Association of Mississauga Logo"/></a>
      <div class="topbar-right">
        <!-- 语言 -->
        <div class="lang-switch" role="group" aria-label="Language">
  <button type="button" class="lang-btn" data-lang="en" aria-pressed="false">EN</button>
  <button type="button" class="lang-btn" data-lang="zh" aria-pressed="false">简</button>
  <button type="button" class="lang-btn" data-lang="zhHant" aria-pressed="false">繁</button>
</div>


        <!-- 搜索（站内） -->
        <form class="search" role="search" action="search.html" method="GET">
          <input type="search" name="q" placeholder="Search …" aria-label="Search" />
          <button type="submit" aria-label="Submit search">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
              <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
          </button>
        </form>

        <a class="btn btn-primary" href="Donate.html" role="button" data-i18n="btn.donate">DONATE</a>

        <!-- 移动端菜单按钮 -->
        <button class="hamburger" aria-label="打开菜单" aria-controls="drawer" aria-expanded="false" id="openMenu">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="#0f172a" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>
    </div>

    <!-- 顶部导航：含下拉 -->
    <div class="main-nav-wrap">
      <nav class="main-nav container" aria-label="Primary">
        <a href="home.html" data-i18n="nav.home">Home</a>
        <a href="about.html" data-i18n="nav.about">About Us</a>
        <a href="team.html" data-i18n="nav.team">Our Team</a>

        <!-- Services 下拉 -->
        <div class="dropdown" id="nav-services">
          <a href="services.html" class="drop-toggle" aria-haspopup="true" aria-expanded="false" data-i18n="nav.services">Services</a>
          <div class="drop-menu" role="menu" aria-label="Services">
            <a href="settlement.html" role="menuitem" data-i18n="nav.services.settlement">Settlement Services</a>
            <a href="language.html" role="menuitem" data-i18n="nav.services.language">Language & Training</a>
            <a href="community.html" role="menuitem" data-i18n="nav.services.community">Community Services</a>
          </div>
        </div>

        <a href="program.html" data-i18n="nav.program">Program</a>
        <a href="events.html" data-i18n="nav.events">Events</a>

        <!-- Join Us 下拉 -->
        <div class="dropdown" id="nav-join">
          <a href="join.html" class="drop-toggle" aria-haspopup="true" aria-expanded="false" data-i18n="nav.join">Join Us</a>
          <div class="drop-menu" role="menu" aria-label="Join Us">
            <a href="membership.html" role="menuitem" data-i18n="nav.join.membership">Membership</a>
            <a href="Volunteer.html" role="menuitem" data-i18n="nav.join.volunteer">Volunteer</a>
            <a href="Donate.html" role="menuitem" data-i18n="nav.join.donate">Donate</a>
          </div>
        </div>

        <a href="contact.html" data-i18n="nav.contact">Contact Us</a>
      </nav>
    </div>
  </header>

  <!-- 抽屉导航（移动端） -->
  <aside class="drawer" id="drawer" aria-hidden="true">
    <header>
      <strong data-i18n="nav.menu">Menu</strong>
      <button class="btn" style="margin-left:auto" id="closeMenu" data-i18n="nav.close">Close</button>
    </header>
    <nav style="overflow:auto;padding-bottom:20px">
      <a href="home.html" data-i18n="nav.home">Home</a>
      <a href="about.html" data-i18n="nav.about">About Us</a>
      <a href="team.html" data-i18n="nav.team">Our Team</a>

      <!-- Services 折叠 -->
      <button class="drawer-toggle" aria-expanded="false" aria-controls="drawer-services" data-i18n="nav.services">Services</button>
      <div id="drawer-services" class="drawer-submenu" role="group" aria-label="Services submenu">
        <a href="settlement.html" data-i18n="nav.services.settlement">Settlement Services</a>
        <a href="language.html" data-i18n="nav.services.language">Language & Training</a>
        <a href="community.html" data-i18n="nav.services.community">Community Services</a>
      </div>

      <a href="program.html" data-i18n="nav.program">Program</a>
      <a href="events.html" data-i18n="nav.events">Events</a>

      <!-- Join Us 折叠 -->
      <button class="drawer-toggle" aria-expanded="false" aria-controls="drawer-join" data-i18n="nav.join">Join Us</button>
      <div id="drawer-join" class="drawer-submenu" role="group" aria-label="Join Us submenu">
        <a href="membership.html" data-i18n="nav.join.membership">Membership</a>
        <a href="Volunteer.html" data-i18n="nav.join.volunteer">Volunteer</a>
        <a href="Donate.html" data-i18n="nav.join.donate">Donate</a>
      </div>

      <a href="contact.html" data-i18n="nav.contact">Contact Us</a>
      <a href="#donate" data-i18n="btn.donate">DONATE</a>
    </nav>
  </aside>

  <section class="page-hero">
    <div class="container">
      <h1 data-i18n="search.title">Search</h1>
      <p id="qtext" style="text-align:center;color:#475569;margin:6px 0 0"></p>
    </div>
  </section>

  <main class="container">
    <div id="result-info" style="margin:10px 0 12px;color:#475569"></div>
    <div id="results" class="results" aria-live="polite"></div>
  </main>

  <!-- Footer（统一样式与结构） -->
  <footer>
    <div class="footer-container">
      <div class="footer-section">
        <h4 data-i18n="footer.hours">Hours of Operations</h4>
        <p data-i18n="footer.hours_value">Mon To Fri: 9 am – 5 pm</p>
        <h4 data-i18n="footer.location">Our Location</h4>
        <p>1177 Central Pkwy W Unit 16, Mississauga, ON L5C 4P3</p>
        <a class="btn btn-primary" href="Donate.html" role="button" data-i18n="btn.donate">DONATE</a>
      </div>
      <div class="footer-section">
        <h4 data-i18n="footer.contact">Contact</h4>
        <p>info@chineseassociationmississauga.com</p>
        <p>Phone：(905) 275-8558</p>
        <div class="footer-social" aria-label="Social links">
          <!-- WeChat -->
          <a href="IMG_4315.JPG" target="_blank" rel="noopener" aria-label="WeChat QR" class="icon-btn">
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
              <circle cx="10" cy="10" r="6" fill="none" stroke="currentColor" stroke-width="1.8"/>
              <path d="M6.2 12.3l-2.4.8 1-2" fill="currentColor"/>
              <circle cx="8.2" cy="10" r="0.8" fill="currentColor"/>
              <circle cx="11.8" cy="10" r="0.8" fill="currentColor"/>
              <circle cx="16" cy="14" r="5" fill="none" stroke="currentColor" stroke-width="1.8"/>
              <path d="M18.8 17.3l2 .9-.6-2" fill="currentColor"/>
              <circle cx="14.6" cy="14" r="0.8" fill="currentColor"/>
              <circle cx="17.4" cy="14" r="0.8" fill="currentColor"/>
            </svg>
          </a>
          <!-- Instagram -->
          <a href="https://www.instagram.com/carassaugachinapavilion/?igsh=MWs3anpnNmlzM3M5YQ%3D%3D&utm_source=qr"
             target="_blank" rel="noopener" aria-label="Instagram" class="icon-btn">
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
              <rect x="3.5" y="3.5" width="17" height="17" rx="4" fill="none" stroke="currentColor" stroke-width="1.8"/>
              <circle cx="12" cy="12" r="4.2" fill="none" stroke="currentColor" stroke-width="1.8"/>
              <circle cx="17" cy="7" r="1.2" fill="currentColor"/>
            </svg>
          </a>
          <!-- Facebook -->
          <a href="https://www.facebook.com/chinapavilion.carassauga/"
             target="_blank" rel="noopener" aria-label="Facebook" class="icon-btn">
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
              <path d="M14 8h2V5h-2c-2.2 0-4 1.8-4 4v2H8v3h2v6h3v-6h2.4l.6-3H13V9c0-.6.4-1 1-1z" fill="currentColor"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
    <div class="bottom" data-i18n="footer.copyright">© Chinese Association of Mississauga. All rights reserved.</div>
  </footer>

  <!-- —— 内联搜索索引（按需增删） —— -->
  <script id="search-index" type="application/json">
  [
    {"url":"home.html","lang":"en","title":"Home","content":"Chinese Association of Mississauga. Welcome to CAM. Programs, services, events, newcomers, seniors, youth, families."},
    {"url":"home.html","lang":"zh","title":"首页","content":"密西沙加华人协会。欢迎来到 CAM。项目 服务 活动 新移民 老年人 青年 家庭。"},
    {"url":"home.html","lang":"zhHant","title":"首頁","content":"密西沙加華人協會。歡迎來到 CAM。項目 服務 活動 新移民 長者 青年 家庭。"},

    {"url":"about.html","lang":"en","title":"About Us","content":"Vision, Mission, Milestones, Annual Reports. Non-profit and registered charity supporting newcomers and community."},
    {"url":"about.html","lang":"zh","title":"关于我们","content":"宗旨 愿景 里程碑 年报。注册慈善、非营利机构，服务新移民与社区。"},
    {"url":"about.html","lang":"zhHant","title":"關於我們","content":"宗旨 願景 里程碑 年報。註冊慈善、非營利機構，服務新移民與社區。"},

    {"url":"team.html","lang":"en","title":"Our Team","content":"Board, LINC/ESL program, Settlement services, Maintenance Services, staff names."},
    {"url":"team.html","lang":"zh","title":"团队","content":"理事会 LINC/ESL 课程 安居服务 维修服务 员工名单。"},
    {"url":"team.html","lang":"zhHant","title":"團隊","content":"理事會 LINC/ESL 課程 安居服務 維修服務 員工名單。"},

    {"url":"join.html","lang":"en","title":"Join Us","content":"Membership, Volunteer, Donate. Apply for membership, sign up as volunteer, donate now."},
    {"url":"join.html","lang":"zh","title":"加入我们","content":"会员 志愿者 捐赠。申请入会、报名志愿者、立即捐赠。"},
    {"url":"join.html","lang":"zhHant","title":"加入我們","content":"會員 志工 捐贈。申請入會、報名志工、立即捐贈。"}
  ]
  </script>

  <!-- —— 多语言词条（统一 cam_lang & 键名与其它页一致） —— -->
  <script>
    const I18N={
      en:{
        "nav.menu":"Menu","nav.close":"Close",
        "nav.home":"Home","nav.about":"About Us","nav.team":"Our Team",
        "nav.services":"Services","nav.services.settlement":"Settlement Services","nav.services.language":"Language & Training","nav.services.community":"Community Services",
        "nav.program":"Program","nav.events":"Events",
        "nav.join":"Join Us","nav.join.membership":"Membership","nav.join.volunteer":"Volunteer","nav.join.donate":"Donate",
        "nav.contact":"Contact Us",
        "btn.donate":"DONATE",
        "search.title":"Search",
        "search.results":"{n} result(s) for “{q}”",
        "search.empty":"No results for “{q}”. Try different keywords.",
        "ph.search":"Search …",
        "footer.hours":"Hours of Operations","footer.hours_value":"Mon To Fri: 9 am – 5 pm","footer.location":"Our Location","footer.contact":"Contact","footer.copyright":"© Chinese Association of Mississauga. All rights reserved."
      },
      zh:{
        "nav.menu":"菜单","nav.close":"关闭",
        "nav.home":"首页","nav.about":"关于我们","nav.team":"团队",
        "nav.services":"服务","nav.services.settlement":"安居服务","nav.services.language":"语言与培训","nav.services.community":"社区服务",
        "nav.program":"课程/项目","nav.events":"活动",
        "nav.join":"加入我们","nav.join.membership":"加入会员","nav.join.volunteer":"申请志愿者","nav.join.donate":"捐款",
        "nav.contact":"联系我们",
        "btn.donate":"捐赠",
        "search.title":"站内搜索",
        "search.results":"“{q}” 的搜索结果：{n} 条",
        "search.empty":"没有找到 “{q}” 的结果，试试其他关键词。",
        "ph.search":"搜索…",
        "footer.hours":"开放时间","footer.hours_value":"周一至周五：9:00 – 17:00","footer.location":"地址","footer.contact":"联系方式","footer.copyright":"© 密西沙加华人协会 保留所有权利"
      },
      zhHant:{
        "nav.menu":"選單","nav.close":"關閉",
        "nav.home":"首頁","nav.about":"關於我們","nav.team":"團隊",
        "nav.services":"服務","nav.services.settlement":"安居服務","nav.services.language":"語言與培訓","nav.services.community":"社區服務",
        "nav.program":"課程／項目","nav.events":"活動",
        "nav.join":"加入我們","nav.join.membership":"加入會員","nav.join.volunteer":"申請義工","nav.join.donate":"捐款",
        "nav.contact":"聯絡我們",
        "btn.donate":"捐贈",
        "search.title":"站內搜尋",
        "search.results":"「{q}」 的搜尋結果：{n} 筆",
        "search.empty":"沒有找到「{q}」的結果，試試其他關鍵字。",
        "ph.search":"搜尋…",
        "footer.hours":"開放時間","footer.hours_value":"週一至週五：9:00 – 17:00","footer.location":"地址","footer.contact":"聯絡方式","footer.copyright":"© 密西沙加華人協會 保留所有權利"
      }
    };
    const LANGS=["en","zh","zhHant"];
    function t(key,lang){return I18N[lang]?.[key]||key}
    function applyI18n(lang){
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k=el.getAttribute('data-i18n'); const val=t(k,lang);
        if(typeof val==='string') el.textContent=val;
      });
      const input=document.querySelector('.search input[name="q"]');
      if(input) input.placeholder = I18N[lang]?.["ph.search"] || "Search …";
      document.documentElement.lang=(lang==="en")?"en":(lang==="zh"?"zh-Hans":"zh-Hant");
      LANGS.forEach(code=>{
        const b=document.querySelector(`.lang-btn[data-lang="${code}"]`);
        if(b) b.setAttribute('aria-pressed',String(code===lang));
      });
    }

    // —— 统一语言：迁移旧 'lang' -> 'cam_lang'，以后只用 'cam_lang'
    (function(){
      const legacy = localStorage.getItem('lang');
      if (legacy && !localStorage.getItem('cam_lang')) localStorage.setItem('cam_lang', legacy);
      localStorage.removeItem('lang'); // 永久移除旧键
      const saved = localStorage.getItem('cam_lang') || 'zh';
      applyI18n(saved);
      renderResults(); // 初始化按当前语言渲染
    })();

    // 语言按钮：只写 cam_lang，并重渲染结果
    document.querySelectorAll('.lang-btn').forEach(b=>b.addEventListener('click',()=>{
      const lang=b.dataset.lang;
      localStorage.setItem('cam_lang', lang);
      applyI18n(lang);
      renderResults();
    }));
  </script>
	

  <!-- —— 搜索脚本 —— -->
  <script>
    function getQuery(){const p=new URLSearchParams(location.search);return (p.get('q')||'').trim();}
    function getIndex(){try{return JSON.parse(document.getElementById('search-index').textContent.trim())}catch(e){return[]}}
    function tokenize(q){
      if(/[a-zA-Z]/.test(q)) return q.toLowerCase().split(/\s+/).filter(Boolean);
      return [q];
    }
    function scoreEntry(entry, tokens){
      let s=0; const title=(entry.title||'').toLowerCase(); const content=(entry.content||'').toLowerCase();
      tokens.forEach(tok=>{
        if(!tok) return;
        if(title.includes(tok)) s+=5;
        const cnt=(content.split(tok).length-1);
        s+=Math.min(cnt,10);
      });
      return s;
    }
    function highlight(text, tokens){
      let html=text;
      tokens.filter(Boolean).forEach(tok=>{
        const re=new RegExp(tok.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'gi');
        html=html.replace(re, m=>`<mark>${m}</mark>`);
      });
      return html;
    }
    function renderResults(){
      const lang=localStorage.getItem('cam_lang')||'zh';
      const q=getQuery();
      const resBox=document.getElementById('results');
      const info=document.getElementById('result-info');
      const qtext=document.getElementById('qtext');
      qtext.textContent = q?('“'+q+'”'):'';
      if(!q){resBox.innerHTML='';info.textContent='';return;}
      const tokens=tokenize(q);
      const index=getIndex().filter(it=>it.lang===lang);
      const results=index.map(it=>({it,score:scoreEntry(it,tokens)})).filter(x=>x.score>0).sort((a,b)=>b.score-a.score);
      if(results.length===0){
        info.textContent = t('search.empty',lang).replace('{q}',q);
        resBox.innerHTML=''; return;
      }
      info.textContent = t('search.results',lang).replace('{q}',q).replace('{n}',results.length);
      resBox.innerHTML=results.map(({it})=>`
        <article class="card">
          <h3><a href="${it.url}">${highlight(it.title,tokens)}</a></h3>
          <p>${highlight(it.content.slice(0,140)+'…',tokens)}</p>
        </article>
      `).join('');
    }
    document.addEventListener('DOMContentLoaded',renderResults);
  </script>

  <!-- —— 交互脚本：下拉与抽屉（与其它页一致） —— -->
  <script>
    // 桌面下拉（Services / Join Us）
    function bindDropdown(id){
      const dd=document.getElementById(id);
      if(!dd) return;
      const toggle=dd.querySelector('.drop-toggle');
      let timer;
      const open=()=>{clearTimeout(timer);dd.classList.add('open');toggle?.setAttribute('aria-expanded','true');};
      const close=()=>{clearTimeout(timer);timer=setTimeout(()=>{dd.classList.remove('open');toggle?.setAttribute('aria-expanded','false');},140);};
      dd.addEventListener('mouseenter',open);
      dd.addEventListener('mouseleave',close);
      dd.addEventListener('focusin',open);
      dd.addEventListener('keydown',e=>{if(e.key==='Escape'){close();toggle?.focus();}});
    }
    bindDropdown('nav-services');
    bindDropdown('nav-join');

    // 抽屉开关
    (function(){
      const drawer=document.getElementById('drawer');
      const openBtn=document.getElementById('openMenu');
      const closeBtn=document.getElementById('closeMenu');
      function setDrawer(open){
        if(!drawer) return;
        drawer.classList.toggle('open',open);
        drawer.setAttribute('aria-hidden',open?'false':'true');
        if(openBtn) openBtn.setAttribute('aria-expanded',open?'true':'false');
        document.body.style.overflow=open?'hidden':'';
      }
      openBtn?.addEventListener('click',()=>setDrawer(true));
      closeBtn?.addEventListener('click',()=>setDrawer(false));
      drawer?.addEventListener('click',e=>{if(e.target===drawer) setDrawer(false)});
      window.addEventListener('keydown',e=>{if(e.key==='Escape'&&drawer?.classList.contains('open')) setDrawer(false)});

      // 抽屉折叠
      function bindDrawerToggle(ctrlId){
        const t=document.querySelector(`.drawer-toggle[aria-controls="${ctrlId}"]`);
        const p=document.getElementById(ctrlId);
        if(!t||!p) return;
        t.addEventListener('click',()=>{
          const isOpen=t.getAttribute('aria-expanded')==='true';
          t.setAttribute('aria-expanded',String(!isOpen));
          p.classList.toggle('open',!isOpen);
        });
      }
      bindDrawerToggle('drawer-services');
      bindDrawerToggle('drawer-join');
    })();
  </script>
</body>
</html>


